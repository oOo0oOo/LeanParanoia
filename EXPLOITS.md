# Exploit Test Files

### CustomAxioms (`checkAxioms`)

- **ProveFalse.lean** - Axiom directly asserting False
- **ProveAnything.lean** - Universal axiom proving any proposition
- **ForgeRunCmd.lean** - Axiom injected via `run_cmd` metaprogramming
- **ForgeRunTac.lean** - Axiom injected via `run_tac` metaprogramming
- **HiddenInMacro.lean** - Axiom concealed behind macro expansion
- **FakeStdLib.lean** - Axiom forged in trusted Std namespace to appear legitimate
- **HiddenInInstance.lean** - Axiom embedded in typeclass instance
- **SkipKernelTC.lean** - Debug option that would skip kernel type checking (represented as axiom)

### Sorry (`checkSorry`)

- **Direct.lean** - Direct `sorry` in proof term
- **Admit.lean** - Proof using `admit` tactic
- **Underscore.lean** - Underscore hole that elaborates to sorry
- **Intermediate.lean** - Sorry in intermediate helper lemma
- **Opaque.lean** - Sorry hidden behind opaque constant definition
- **ProofAsSorry.lean** - Debug option making proof terms elaborate to sorry
- **ByAsSorry.lean** - Debug option making tactic blocks elaborate to sorry
- **TerminalTactics.lean** - Debug option making terminal tactics elaborate to sorry

### Metavariables (`checkMetavariables`)

- **TypeclassFail.lean** - Failed typeclass search leaving metavariables
- **Timeout.lean** - Tactic timeout leaving unresolved holes

### Unsafe (`checkUnsafe`)

- **UnsafeDefinition.lean** - Definition marked unsafe to bypass kernel verification

### Partial (`checkPartial`)

- **NonTerminating.lean** - Infinite loop marked partial to bypass termination checker

### Extern (`checkExtern`)

- **ExternFFI.lean** - `@[extern]` attribute linking to C code
- **ExportC.lean** - `@[export]` attribute exposing to C ABI
- **InitHook.lean** - `@[init]` attribute for initialization hooks
- **BuiltinInit.lean** - `@[builtin_init]` attribute for built-in initialization
- **PrivateExtern.lean** - Private declarations with extern to evade detection
- **CoreNamespace.lean** - Extern in Lean.* namespace to appear legitimate

### ImplementedBy (`checkImplementedBy`)

- **DirectReplacement.lean** - Basic `@[implemented_by]` replacement
- **ChainedReplacement.lean** - Multi-hop replacement chain ending in extern
- **PrivateImpl.lean** - Private implemented_by to evade detection

### CSimp (`checkCSimp`)

- **WithAxiom.lean** - CSimp theorem proven using custom axiom
- **WithUnsafe.lean** - CSimp with unsafe code in replacement target

### NativeComputation (`checkNativeComputation`)

- **NativeDecide.lean** - Using `native_decide` to trust compiled code
- **OfReduce.lean** - Using reduction primitives that trust compiler

### SourcePatterns (`checkSource`)

- **LocalInstance.lean** - Local typeclass instance changing semantics
- **LocalInstanceArithmetic.lean** - Local instance redefining arithmetic (1+1=3)
- **LocalNotation.lean** - Local notation redefining operators
- **LocalMacroRules.lean** - Local macro_rules changing elaboration
- **NotationRedefinition.lean** - Local notation redefining built-ins (True)
- **ScopedNotation.lean** - Scoped notation changing meaning within sections

### ConstructorIntegrity (`checkConstructors`)

- **ManualConstructor.lean** - Manually forged constructor bypassing kernel generation

### RecursorIntegrity (`checkRecursors`)

- **MissingRecursor.lean** - Inductive without proper recursor (same as ManualConstructor)

### KernelRejection (always checked)

- **NonPositive.lean** - Non-positive inductive type rejected by kernel
- **UnsafeCast.lean** - Unsafe type cast rejected by kernel

### Replay (`enableReplay`)
Tests for corrupted .olean file detection (tested in Python, not Lean files).

### Transitive (tests dependency tracking)

- **DeepAxiom_L0.lean** - Custom axiom at level 0
- **DeepAxiom_L1.lean** - Theorem using axiom from L0
- **DeepSorry_L0.lean** - Sorry at level 0
- **DeepSorry_L1.lean** - Uses sorry from L0 (1 level deep)
- **DeepSorry_L2.lean** - Uses sorry from L1 (2 levels deep)
- **BadLib.lean** - External library with malicious axioms
- **UsesBadLib.lean** - Theorem depending on BadLib
- **Level0_Clean.lean** - Valid base dependency
- **Level1_UsesClean.lean** - Valid dependency using L0
- **Level2_UsesBoth.lean** - Valid multi-level dependencies

### Valid (positive test cases)

- **Simple.lean** - Simple valid theorem
- **WithAxioms.lean** - Uses whitelisted Classical axioms
- **Dependencies.lean** - Uses valid helper from another file
- **Helper.lean** - Helper theorem for Dependencies
- **UnsafeReducibility.lean** - Uses allowUnsafeReducibility (harmless debug option)
