"""
Tests for custom axiom exploit detection.
"""

import pytest


@pytest.mark.exploit
@pytest.mark.parametrize(
    "module,theorem",
    [
        ("LeanTestProject.Axioms.False", "exploit_theorem"),
        ("LeanTestProject.Axioms.Magic", "exploit_theorem"),
        ("LeanTestProject.Axioms.RunTac", "exploit_theorem"),
        ("LeanTestProject.Axioms.RunCmd", "exploit_theorem"),
        ("LeanTestProject.Axioms.MacroExpansion", "exploit_theorem"),
        ("LeanTestProject.Axioms.ForgeStd", "exploit_theorem"),
    ],
)
def test_custom_axiom_variants(verifier, module, theorem):
    """Test custom axiom exploits are detected"""
    result = verifier.verify_theorem(module, theorem)

    assert not result.success, f"Should reject {module}"
    assert "AxiomWhitelist" in result.failed_tests
