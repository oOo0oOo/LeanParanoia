"""
Tests for partial function exploit detection.
"""

import pytest


@pytest.mark.exploit
def test_partial_function_rejected(verifier):
    """Test that theorems depending on partial functions are rejected"""
    result = verifier.verify_theorem(
        "LeanTestProject.Partial.NonTerminating", "exploit_theorem"
    )

    assert not result.success
    # The theorem itself uses sorry, so it will fail Sorry check
    # But the partial function should also trigger Partial check
    assert "Sorry" in result.failed_tests or "Partial" in result.failed_tests
