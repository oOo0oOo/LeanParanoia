"""
Tests for type class instance manipulation exploits.
"""

import pytest


@pytest.mark.exploit
def test_local_malicious_instance(verifier, default_config):
    """A type class instance that hides an axiom should be detected."""
    result = verifier.verify_theorem(
        "LeanTestProject.Typeclass.MaliciousInstance",
        "exploit_theorem",
        config=dict(default_config),
    )

    assert not result.success
    # The instance uses an axiom (hidden_axiom)
    assert "AxiomWhitelist" in result.failed_tests
