"""
Tests for unsafe code exploit detection.
"""

import pytest


@pytest.mark.exploit
def test_unsafe_definition_rejected(verifier):
    """Test that unsafe definitions are rejected."""
    result = verifier.verify_theorem(
        "LeanTestProject.Unsafe.UnsafeDef", "exploit_theorem"
    )

    assert not result.success
    # UnsafeDef uses axioms which are caught by axiom whitelist
    assert "NoUnsafe" in result.failed_tests
