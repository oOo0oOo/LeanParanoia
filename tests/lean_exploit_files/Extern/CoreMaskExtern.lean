-- Extern with Lean.* namespace bypassing core module trust checks
-- Tests that fake namespaces under Lean.* don't bypass security
namespace Lean.Evil

@[extern "evil_add"]
def fakeAdd (n m : Nat) : Nat := n + m

end Lean.Evil

namespace Lean.Magic

@[extern "magic_mul"]
def fakeMul (n m : Nat) : Nat := n * m

end Lean.Magic

-- Both should be caught despite being under Lean namespace
axiom exploit_axiom : Lean.Evil.fakeAdd 1 1 = 3 âˆ§ Lean.Magic.fakeMul 2 3 = 7

theorem exploit_theorem : 1 + 1 = 3 := exploit_axiom.1
