-- Implemented by attribute uses different runtime implementation
-- The exploit: VM executes wrongAddImpl, kernel sees seemsCorrectAdd
unsafe def wrongAddImpl (n m : Nat) : Nat := n + m + 1

@[implemented_by wrongAddImpl]
def seemsCorrectAdd (n m : Nat) : Nat := n + m

-- At runtime, this would evaluate to 3 (via wrongAddImpl), not 2
axiom exploit_axiom : seemsCorrectAdd 1 1 = 3

theorem exploit_theorem : 1 + 1 = 3 := exploit_axiom
